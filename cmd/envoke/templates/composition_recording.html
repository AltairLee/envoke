{{define "head"}}
  <title>{{ .Title}}</title>
{{end}}

{{define "body"}}
<header>RIGHT</header>
<form id="right-form" name="right-form">
    <input type="text" name="infoId" placeholder="INFO ID" required /><br>
    <input type="number" name="percentageShares" placeholder="PERCENTAGE SHARES" min=1 max=100 required /><br>
    <label>VALID FROM</label>
    <input type="date" name="validFrom" required /><br>
    <label>VALID TO</label>
    <input type="date" name="validTo" required /><br>
    <input type="submit" value="submit" />
</form>
<header>COMPOSITION INFO</header>
<form id="composition-form" name="composition-form">
    <input type="text" name="composerId" placeholder="COMPOSER ID" required /><br>
    <input type="text" name="publisherId" placeholder="PUBLISHER ID" required /><br>
    <input type="text" name="title" placeholder="TITLE" required /><br>
    <input type="submit" value="submit" />
</form>
<header>PUBLISH COMPOSITION</header>
<form id="publish-form" name="publish-form">
    <input type="text" name="infoId" placeholder="INFO ID" required /><br>
    <input type="text" name="rightIds" placeholder="RIGHT IDs" required /><br>
    <input type="submit" value="publish" />
</form>
<header>RECORDING INFO</header>
<form id="recording-form" name="recording-form" enctype="multipart/form-data">
    <input type="text" name="compositionId" placeholder="COMPOSITION ID" required /><br>
    <input type="text" name="labelId" placeholder="RECORD LABEL ID" required /><br>
    <input type="text" name="performerId" placeholder="PERFORMER ID" required /><br>
    <input type="text" name="producerId" placeholder="PRODUCER ID" required /><br>
    <input type="text" name="publishingLicenseId" placeholder="PUBLISHING LICENSE ID" /><br>
    <input accept="audio" type="file" name="recording" required /><br>
    <input type="submit" value="submit" />
</form>
<header>RELEASE RECORDING</header>
<form id="release-form" name="release-form">
    <input type="text" name="infoId" placeholder="INFO ID" required /><br>
    <input type="text" name="rightIds" placeholder="RIGHT IDs" required /><br>
    <input type="submit" value="release" />
</form>
<header>SEARCH</header>
<form id="search-form" name="search-form">
    <input type="text" name="modelId" placeholder="COMPOSITION/RECORDING ID" required /><br>
    <select form="search-form" name="field" required>
        <option value="" disabled selected></option>
        <option value="composer">COMPOSER</option>
        <option value="composition">COMPOSITION</option>
        <option value="label">LABEL</option>
        <option value="performer">PERFORMER</option>
        <option value="producer">PRODUCER</option>
        <option value="publisher">PUBLISHER</option>
        <option value="publishingLicense">PUBLISHING LICENSE</option>
        <option value="rights">RIGHTS</option>
        <option value="title">TITLE</option>
    </select>
    <input type="submit" value="search" />
</form>
<pre id="message"></pre>
<script type="text/javascript">

function httpPostAsync(addr, data, callback) {
    var xhr = new XMLHttpRequest ();
    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4) {
            if (xhr.status == 200) {
                callback(xhr.responseText);
            } else {
                alert(xhr.responseText);
            };
        };
    };
    xhr.open("POST", addr, true); 
    xhr.send(data);
};

var callback = function(responseText) {
    if (responseText != null) {
        var json = JSON.parse(responseText);
        var str = JSON.stringify(json,null,2);
        $("#message").text(str);
    };
};

window.onload = function() {
  var rightForm = $("#right-form");
  rightForm.submit(function(event) {
    event.preventDefault();
    var formData = rightForm.serialize();
    httpPostAsync("http://localhost:8888/right", formData, callback);
  });

  var compositionForm = $("#composition-form");
  compositionForm.submit(function(event) {
    event.preventDefault();
    var formData = compositionForm.serialize();
    httpPostAsync("http://localhost:8888/composition", formData, callback);
  });

  var recordingForm = $("#recording-form");
  recordingForm.submit(function(event) {
    event.preventDefault();
    var formData = new FormData(event.target);
    httpPostAsync("http://localhost:8888/recording", formData, callback);
  });

  var publishForm = $("#publish-form");
  publishForm.submit(function(event){
    event.preventDefault();
    var formData = publishForm.serialize();
    httpPostAsync("http://localhost:8888/publish", formData, callback);
  });

  var releaseForm = $("#release-form");
  releaseForm.submit(function(event){
    event.preventDefault();
    var formData = releaseForm.serialize();
    httpPostAsync("http://localhost:8888/release", formData, callback);
  })

  var searchForm = $("#search-form");
  searchForm.submit(function(event){
    event.preventDefault();
    var formData = searchForm.serialize();
    httpPostAsync("http://localhost:8888/search", formData, callback);
  });
}
</script>
{{end}}